【開発経緯】

長らくCaption2Ass_PCR.exeにて、使用させて頂きました
「Caption.dll 0114改造版」ですが、非常に残念なことに
中の人が公開を止められました
このような良いソフトが消えるのは、ツライです

＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

しかたないので、mod1さんが以前に公開されていた
「Caption.dll 0111改造版」のソースコードと
「EpgDataCap_Bon（人柱版８．５６）」のソースコード
「odaruさんの字幕 Plugin For TVTest(20081216)」の
ソースコードを元にしてユニコードに対応した
「Caption.dll 0200改造版」を作りました

「しぃぬこ @ ウィキ」の「字幕抽出ツール C-Cats」を
参考にしました
同梱の「cc_gaiji.ini」と「UNICODE_cc_gaiji.ini」も
「字幕抽出ツール C-Cats」からコピーさせて頂きました

＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

その後も改造・公開してきました。しかし、
>>(2012.07.01 11:22:04)
>>公開停止願いさん
>>mod1によるコードを含んだソースおよびその成果物の
>>公開を停止するよう強くお願いいたします。
との公開停止の要望がありました
そこで、mod1さんに依る改造部分をTVCaptionMod2の中の人が
独自実装されている外字テーブルとDRCS取得部分の流用することで
公開可能なCaption.dllを作りました

＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊
【動作環境】
・Windows XP SP3で開発(たぶんVistaや７でも動くと思います)
・Visual C++ 2010 SP1 再頒布可能パッケージ


【使用方法】
・Caption2Ass_PCR.exe と 「Caption.dll ユニコード化改造版」を
  同じフォルダーに置く。
・Gaijiフォルダ下に「外字代用」のiniファィルがあると、変換テーブルとして
  起動時に読み込みます。書式はC-Cats互換となります
  （iniファイル自体がC-Catsのものになります）。
・ユニコード用のiniファィルは、utf16leで記述
・アプリケーションから「InitializeUNICODECP」を呼べばユニコード・モードに
  なります
  １．初期化で「UNICODE_cc_○○.ini」を読み込む
  ２．アプリケーションに、文字列をUTF8で渡す
・アプリケーションから「InitializeCP」を呼べばシフト・ジス・モードに
  なります
  １．初期化で「cc_○○.ini」を読み込む
  ２．アプリケーションに、文字列をS-JISで渡す

【ライセンス関係】
このCaption.dll改造版は、オリジナル版の以下ライセンスに従います
改変や流用にあたって当方に連絡は不要です。
以下はオリジナル版付属のReadme.txtのライセンス関連部分です。
自ずと本改造版も以下に従います。
-------------
●EpgDataCap_Bon、TSEpgView_Sample、NetworkRemocon、Caption、TSEpgViewServerの
ソースの取り扱いについて
　特にGPLとかにはしないので自由に改変してもらって構わないです。
　改変して公開する場合は改変部分のソースぐらいは一緒に公開してください。
　（強制ではないので別に公開しなくてもいいです）
　EpgDataCap.dllの使い方の参考にしてもらうといいかも。

●EpgDataCap.dll、Caption.dllの取り扱いについて
　フリーソフトに組み込む場合は特に制限は設けません。ただし、dllはオリジナルのまま
　組み込んでください。
　このdllを使用したことによって発生した問題について保証は一切行いません。
　商用、シェアウェアなどに組み込むのは不可です。
-------------

【謝辞】
Special thanks to
・「Caption2Ass 補完計画（Cleanup code）」を公開してくれた方
・odaruさん、
・mod1の中の人さん、
・EDCBの中の人さん、
・TVCaptionMod2の中の人さん、
・字幕抽出ツール C-Cats の作者さん、
・人柱になってデバッグにお付き合いいただいている方々
皆さんのおかげでつくれました

【Caption.dllのユニコード対応版の変更履歴】
2012-09-13
0,4,0,3
・assにて一部で座標がXYともに半分の数値にになる不具合の修正

2012-07-14
0,4,0,2
・UNICODE_cc_DRCSに載ってるのはことごとくNFになる不具合の修正
（報告頂きました通りでした）

2012-07-12
0,4,0,1
・TVCaptionMod2の中の人が独自実装されているDRCS取得部分の流用
・TVCaptionMod2の中の人に教えて頂いたBMP形式で保存の使用
等で公開可能なCaption.dllを作りました

2012-07-04
0,4,0,0 非公開
・mod1さんに依る改造部分を削除しました

2012-05-23
0,3,0,0
＊このバージョンは、odaruさん及び、mod1の中の人さんの
．Caption.dllとの互換性がありません
・HLCとAPFに対応してみた

2012-04-20
0,2,0,8
・PAPF(指定動作位置前進)の対応を改善した
・Ｙ座標の初期化の処理を改善した

2012-04-14
0,2,0,7
・PAPF(指定動作位置前進)に対応した
・間違った修正だったので、ver.0,2,0,6の修正を元に戻した

2012-04-12
0,2,0,6 ＊ 間違った修正だったので、翌日に削除しました
・「自動改行処理」でＸ座標の設定を間違えていたので修正した

2012-01-23
0,2,0,5
・複数のDRCS図形文字の定義時の複数のサイズの混在に対応した

2012-01-20
0,2,0,4
・漢字が英数字２文字になる誤変換に対策をした

2012-01-19
0,2,0,3
・漢字が英数字２文字になる誤変換を仮対応
  仮対応の為にソースは、入れてないです

2011-12-31
0,2,0,2
・DRCSで再定義されていた文字に、最初のMD5を戻していたバグを修正した

2011-12-03
0,2,0,1
・字幕表示位置の計算を向上した
・字幕表示領域を超える時には、自動で改行を行うようにした
・RPCによる行末まで繰り返し指定に対応

2011-11-27
0,2,0,0
・字幕抽出ツール C-Catsを参考にして、ARIBの追加記号と追加漢字のテーブル定義を
  iniファィルで行うようにした
・全角 -> 半角を行うようにした
・RPCによる繰り返し指定に対応。行末まで繰り返し指定については10回繰り返しの簡易対応

2011-10-xx
0,1,1,1
「Caption.dll 0111改造版」のソースコードと
「EpgDataCap_Bon（人柱版８．５６）」のソースコード
を元にコンパイルした
  ここが、出発点。
